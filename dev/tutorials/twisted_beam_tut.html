<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>- Introduce definition of the shell model. · FinEtoolsFlexStructuresTutorials.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">FinEtoolsFlexStructuresTutorials.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="tutorials.html">Tutorials</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="twisted_beam_tut.html">- Introduce definition of the shell model.</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="twisted_beam_tut.html">- Introduce definition of the shell model.</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PetrKryslUCSD/FinEtoolsFlexStructuresTutorials.jl/blob/master/docs/src/tutorials/twisted_beam_tut.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>Static analysis of clamped twisted beam</p><p>Source code: <a href="twisted_beam_tut.jl"><code>twisted_beam_tut.jl</code></a></p><h2 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h2><p>The initially twisted cantilever beam is one of the standard test problems for verifying the finite-element accuracy [1]. The beam is clamped at one end and loaded either with unit in-plane or unit out-of-plane force at the other. The centroidal axis of the beam is straight at the undeformed  configuration, while its cross-sections are twisted about the centroidal axis from 0 at the clamped end to pi/2 at the free end.</p><p>Reference deflection in the direction of the applied force. | Cross section thickness       | Loading in the Z direction | Loading in the Y direction | | –––-   |     –––-  |  –––- | | t = 0.32 | 0.005425   |    0.001753  | | t = 0.0032 |  0.005256  |  0.001294    |</p><p>References:</p><p>[1] MacNeal,  R. H., and R. L. Harder, “A Proposed Standard Set of Problems to Test Finite Element Accuracy,” Finite Elements in Analysis Design, vol. 11, pp. 3–20, 1985.</p><p>[2] Simo,  J. C., D. D. Fox, and M. S. Rifai, “On a Stress Resultant Geometrically Exact Shell Model. Part II: The Linear Theory; Computational Aspects,” Computational Methods in Applied Mechanical Engineering, vol. 73, pp. 53–92, 1989.</p><p>[3] Zupan D, Saje M (2004) On &quot;A proposed standard set of problems to test finite element accuracy&quot;: the twisted beam. Finite Elements in Analysis and Design 40: 1445-1451.</p><h2 id="Goals"><a class="docs-heading-anchor" href="#Goals">Goals</a><a id="Goals-1"></a><a class="docs-heading-anchor-permalink" href="#Goals" title="Permalink"></a></h2><h1 id="Introduce-definition-of-the-shell-model."><a class="docs-heading-anchor" href="#Introduce-definition-of-the-shell-model.">- Introduce definition of the shell model.</a><a id="Introduce-definition-of-the-shell-model.-1"></a><a class="docs-heading-anchor-permalink" href="#Introduce-definition-of-the-shell-model." title="Permalink"></a></h1><h1 id="Calculate-the-discrete-model-quantities-and-solve-the-static-equilibrium-problem."><a class="docs-heading-anchor" href="#Calculate-the-discrete-model-quantities-and-solve-the-static-equilibrium-problem.">- Calculate the discrete model quantities and solve the static equilibrium problem.</a><a id="Calculate-the-discrete-model-quantities-and-solve-the-static-equilibrium-problem.-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-the-discrete-model-quantities-and-solve-the-static-equilibrium-problem." title="Permalink"></a></h1><h1 id="Demonstrate-visualization-of-the-resultant-section-forces-and-moments."><a class="docs-heading-anchor" href="#Demonstrate-visualization-of-the-resultant-section-forces-and-moments.">- Demonstrate visualization of the resultant section forces and moments.</a><a id="Demonstrate-visualization-of-the-resultant-section-forces-and-moments.-1"></a><a class="docs-heading-anchor-permalink" href="#Demonstrate-visualization-of-the-resultant-section-forces-and-moments." title="Permalink"></a></h1><h2 id="Definition-of-the-basic-inputs"><a class="docs-heading-anchor" href="#Definition-of-the-basic-inputs">Definition of the basic inputs</a><a id="Definition-of-the-basic-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-the-basic-inputs" title="Permalink"></a></h2><p>The finite element code relies on the basic functionality implemented in this package.</p><pre><code class="language-julia hljs">using LinearAlgebra
using FinEtools
using FinEtoolsDeforLinear
using FinEtoolsFlexStructures.FESetShellT3Module: FESetShellT3
using FinEtoolsFlexStructures.FEMMShellT3FFModule
using FinEtoolsFlexStructures.RotUtilModule: initial_Rfield, update_rotation_field!
using FinEtools.MeshExportModule.VTKWrite: vtkwrite</code></pre><p>The inputs are defined in consistent units. The elastic properties are:</p><pre><code class="language-julia hljs">E = 0.29e8;
nu = 0.22;</code></pre><p>The material is elastic isotropic.</p><pre><code class="language-julia hljs">mater = MatDeforElastIso(DeforModelRed3D, E, nu)</code></pre><p>Here are the cross-section width and the cantilevered length of the beam.</p><pre><code class="language-julia hljs">W = 1.1;
L = 12.0;</code></pre><h2 id="Reference-Solutions"><a class="docs-heading-anchor" href="#Reference-Solutions">Reference Solutions</a><a id="Reference-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Reference-Solutions" title="Permalink"></a></h2><p>The reference solutions are defined by these tuples of values: thickness, magnitude of the force, direction of the force, and the reference deflection along the force.</p><pre><code class="language-julia hljs">params_thicker_dir_3 = (t = 0.32, force = 1.0, dir = 3, uex = 0.005424534868469);
params_thicker_dir_2 = (t = 0.32, force = 1.0, dir = 2, uex = 0.001753248285256);

params_thinner_dir_3 = (t = 0.0032, force = 1.0e-6, dir = 3, uex = 0.005256);
params_thinner_dir_2 = (t = 0.0032, force = 1.0e-6, dir = 2, uex = 0.001294);</code></pre><p>Now select one particular simulation. Here we go with the thicker shell and the direction of the load 3:</p><pre><code class="language-julia hljs">params = params_thicker_dir_3</code></pre><h2 id="Mesh-generation"><a class="docs-heading-anchor" href="#Mesh-generation">Mesh generation</a><a id="Mesh-generation-1"></a><a class="docs-heading-anchor-permalink" href="#Mesh-generation" title="Permalink"></a></h2><p>The mesh is initially generated for a rectangular 2d domain. The element size can be controlled with these two variables:</p><pre><code class="language-julia hljs">nL = 48;
nW = 8;
nL, nW = 8, 4

fens, fes = T3block(L, W, nL, nW, :a);</code></pre><p>The 2d mesh is expanded into a three dimensional domain, and the locations of the nodes are tweaked to produce the pre twisted shape.</p><pre><code class="language-julia hljs">fens.xyz = xyz3(fens)
for i in 1:count(fens)
    a = fens.xyz[i, 1] / L * (pi / 2)
    y = fens.xyz[i, 2] - (W / 2)
    z = fens.xyz[i, 3]
    fens.xyz[i, :] = [fens.xyz[i, 1], y * cos(a) - z * sin(a), y * sin(a) + z * cos(a)]
end</code></pre><p>The implementation of the 3-node triangle shell element is in this module. We will refer to the functions that we need from this module by referencing them relative to the module name.</p><pre><code class="language-julia hljs">t3ffm = FEMMShellT3FFModule</code></pre><p>The shell elements have a type <code>FESetShellT3</code>. The type of the mesh is the plain isoparametric triangle, which is instructed to delegate to the shell element.</p><pre><code class="language-julia hljs">sfes = FESetShellT3()
accepttodelegate(fes, sfes)</code></pre><p>Use the convenience function to make an instance of the finite element model machine for the T3FF shell.</p><pre><code class="language-julia hljs">femm = t3ffm.make(IntegDomain(fes, TriRule(1), params.t), mater)</code></pre><p>Construct the requisite fields, geometry and displacement. Initialize configuration variables. Displacements are all zero, the rotation matrices are all identities.</p><pre><code class="language-julia hljs">geom0 = NodalField(fens.xyz)
u0 = NodalField(zeros(size(fens.xyz, 1), 3))
Rfield0 = initial_Rfield(fens)
dchi = NodalField(zeros(size(fens.xyz, 1), 6))</code></pre><p>Apply supports. The clamped end is selected based on the X coordinate. We will select all nodes within a box, and the box is slightly inflated using the geometrical tolerance based on the spacing of the nodes.</p><pre><code class="language-julia hljs">tolerance = min(W / nW, L / nL) / 100

l1 = selectnode(fens; box = Float64[0 0 -Inf Inf -Inf Inf], inflate = tolerance)
for i in 1:6
    setebc!(dchi, l1, true, i)
end
applyebc!(dchi)
numberdofs!(dchi);</code></pre><p>Associate the finite element model machine with geometry. The shell formulation requires knowledge of the normals to the shell surface, and that information is computed from the positions of the nodes.</p><pre><code class="language-julia hljs">t3ffm.associategeometry!(femm, geom0)</code></pre><p>Assemble the system stiffness matrix.</p><pre><code class="language-julia hljs">K = t3ffm.stiffness(femm, geom0, u0, Rfield0, dchi);</code></pre><p>Though load is a concentrated force applied at the center of the beam. First we select the node.</p><pre><code class="language-julia hljs">nl = selectnode(fens; box = Float64[L L 0 0 0 0], tolerance = tolerance)</code></pre><p>Next we create a mesh of the loaded boundary (i.e. the selected node), so that we can integrate along it.</p><pre><code class="language-julia hljs">loadbdry = FESetP1(reshape(nl, 1, 1))</code></pre><p>Now we create a finite element model machine that knows how to integrate. Since our boundary consists of a single point, we use a point rule.</p><pre><code class="language-julia hljs">lfemm = FEMMBase(IntegDomain(loadbdry, PointRule()))</code></pre><p>Now we create a force intensity to represent the loading.</p><pre><code class="language-julia hljs">v = FFlt[0, 0, 0, 0, 0, 0]
v[params.dir] = params.force
fi = ForceIntensity(v);</code></pre><p>Finally we computed the load vector corresponding to the force intensity.</p><pre><code class="language-julia hljs">F = distribloads(lfemm, geom0, dchi, fi, 3);</code></pre><p>The system of linear algebraic equations of balance is solved for the displacements and rotations.</p><pre><code class="language-julia hljs">U = K \ F</code></pre><p>The vector of unknowns is now distributed into a field.</p><pre><code class="language-julia hljs">scattersysvec!(dchi, U[:])</code></pre><p>The deflection in the correct direction at the loaded node is now extracted.</p><pre><code class="language-julia hljs">tipdefl = dchi.values[nl, params.dir][1]
@show tipdefl / params.uex * 100</code></pre><p>Generate a graphical display of resultants. The resultants only make sense in a coordinate system aligned with the shell surface. Here we construct such a coordinate system by using the tangent directions to the surface to construct the normal, and the vector along the global X axis will serve as the first basis vector of the local cartesian coordinate system.</p><pre><code class="language-julia hljs">function updatecsys!(csmatout::FFltMat, XYZ::FFltMat, tangents::FFltMat, fe_label::FInt)</code></pre><p>first the normal</p><pre><code class="language-julia hljs">    cross3!(view(csmatout, :, 3), view(tangents, :, 1), view(tangents, :, 2))
    csmatout[:, 3] ./= norm(view(csmatout, :, 3))
    csmatout[:, 1] .= (1.0, 0.0, 0.0)
    cross3!(view(csmatout, :, 2), view(csmatout, :, 3), view(csmatout, :, 1))
    return csmatout
end
ocsys = CSys(3, 3, updatecsys!)
scalars = []
for nc in 1:3
    fld = fieldfromintegpoints(femm, geom0, dchi, :moment, nc, outputcsys = ocsys)</code></pre><p>fld = elemfieldfromintegpoints(femm, geom0, dchi, :moment, nc)</p><pre><code class="language-julia hljs">    push!(scalars, (&quot;m$nc&quot;, fld.values))
end
vtkwrite(&quot;twisted_beam-m.vtu&quot;, fens, fes; scalars = scalars, vectors = [(&quot;u&quot;, dchi.values[:, 1:3])])
scalars = []
for nc in 1:3
    fld = fieldfromintegpoints(femm, geom0, dchi, :membrane, nc, outputcsys = ocsys)</code></pre><p>fld = elemfieldfromintegpoints(femm, geom0, dchi, :moment, nc)</p><pre><code class="language-julia hljs">    push!(scalars, (&quot;n$nc&quot;, fld.values))
end
vtkwrite(&quot;twisted_beam-n.vtu&quot;, fens, fes; scalars = scalars, vectors = [(&quot;u&quot;, dchi.values[:, 1:3])])
scalars = []
for nc in 1:2
    fld = fieldfromintegpoints(femm, geom0, dchi, :shear, nc, outputcsys = ocsys)</code></pre><p>fld = elemfieldfromintegpoints(femm, geom0, dchi, :moment, nc)</p><pre><code class="language-julia hljs">    push!(scalars, (&quot;q$nc&quot;, fld.values))
end
vtkwrite(&quot;twisted_beam-q.vtu&quot;, fens, fes; scalars = scalars, vectors = [(&quot;u&quot;, dchi.values[:, 1:3])])

true</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 14 January 2022 04:13">Friday 14 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
