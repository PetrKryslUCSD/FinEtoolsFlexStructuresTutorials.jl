<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Modal analysis of a free-floating steel circle · FinEtoolsFlexStructuresTutorials.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">FinEtoolsFlexStructuresTutorials.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="tutorials.html">Tutorials</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="circle_modal_conv_tut.html">Modal analysis of a free-floating steel circle</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="circle_modal_conv_tut.html">Modal analysis of a free-floating steel circle</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PetrKryslUCSD/FinEtoolsFlexStructuresTutorials.jl/blob/master/docs/src/tutorials/circle_modal_conv_tut.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Modal-analysis-of-a-free-floating-steel-circle"><a class="docs-heading-anchor" href="#Modal-analysis-of-a-free-floating-steel-circle">Modal analysis of a free-floating steel circle</a><a id="Modal-analysis-of-a-free-floating-steel-circle-1"></a><a class="docs-heading-anchor-permalink" href="#Modal-analysis-of-a-free-floating-steel-circle" title="Permalink"></a></h1><p>Source code: <a href="circle_modal_conv_tut.jl"><code>circle_modal_conv_tut.jl</code></a></p><h2 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h2><p>Vibration analysis of a free-floating steel ring. This is a benchmark from the NAFEMS Selected Benchmarks for Natural Frequency Analysis, publication: Test VM09: Circular Ring –  In-plane and Out-of-plane Vibration.</p><p>The results can be compared with analytical expressions, but the main purpose is to compute data for extrapolation to the limit to predict the true natural frequencies.</p><h2 id="Reference-frequencies"><a class="docs-heading-anchor" href="#Reference-frequencies">Reference frequencies</a><a id="Reference-frequencies-1"></a><a class="docs-heading-anchor-permalink" href="#Reference-frequencies" title="Permalink"></a></h2><p>There will be 6 rigid body modes (zero natural frequencies).</p><p>The numerical results are due to the publication: NAFEMS Finite Element Methods &amp; Standards, Abbassian, F., Dawswell, D. J., and Knowles, N. C. Selected Benchmarks for Natural Frequency Analysis, Test No.</p><ol><li>Glasgow: NAFEMS, Nov., 1987.</li></ol><p>The reference values were analytically determined (Blevins, FORMULAS FOR DYNAMICS, ACOUSTICS AND VIBRATION, Table 4.16). Note that shear flexibility was neglected when computing the reference values.</p><table><tr><th style="text-align: right">Mode</th><th style="text-align: right">Reference Value (Hz)</th><th style="text-align: right">NAFEMS Target Value (Hz)</th></tr><tr><td style="text-align: right">7, 8</td><td style="text-align: right">(out of plane)</td><td style="text-align: right">51.85</td></tr><tr><td style="text-align: right">9, 10</td><td style="text-align: right">(in plane)</td><td style="text-align: right">53.38</td></tr><tr><td style="text-align: right">11, 12</td><td style="text-align: right">(out of plane)</td><td style="text-align: right">148.8</td></tr><tr><td style="text-align: right">13, 14</td><td style="text-align: right">(in plane)</td><td style="text-align: right">151.0</td></tr><tr><td style="text-align: right">15, 16</td><td style="text-align: right">(out of plane)</td><td style="text-align: right">287.0</td></tr><tr><td style="text-align: right">17, 18</td><td style="text-align: right">(in plane)</td><td style="text-align: right">289.5</td></tr></table><h2 id="Goals"><a class="docs-heading-anchor" href="#Goals">Goals</a><a id="Goals-1"></a><a class="docs-heading-anchor-permalink" href="#Goals" title="Permalink"></a></h2><ul><li>Show convergence relative to reference values.</li><li>Compute data for extrapolation to the limit to predict the true natural frequencies.</li></ul><pre><code class="language-julia hljs">#</code></pre><h2 id="Definition-of-the-basic-inputs"><a class="docs-heading-anchor" href="#Definition-of-the-basic-inputs">Definition of the basic inputs</a><a id="Definition-of-the-basic-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-the-basic-inputs" title="Permalink"></a></h2><p>Include the needed packages and modules.</p><pre><code class="language-julia hljs">using Arpack
using FinEtools
using FinEtoolsDeforLinear
using FinEtoolsFlexStructures.MeshFrameMemberModule: frame_member
using FinEtoolsFlexStructures.CrossSectionModule: CrossSectionCircle
using FinEtoolsFlexStructures.FEMMCorotBeamModule
CB = FEMMCorotBeamModule
using FinEtoolsFlexStructures.FEMMCorotBeamModule: FEMMCorotBeam
using FinEtoolsFlexStructures.FESetCorotBeamModule: MASS_TYPE_CONSISTENT_NO_ROTATION_INERTIA,
    MASS_TYPE_CONSISTENT_WITH_ROTATION_INERTIA,
    MASS_TYPE_LUMPED_DIAGONAL_NO_ROTATION_INERTIA,
    MASS_TYPE_LUMPED_DIAGONAL_WITH_ROTATION_INERTIA</code></pre><p>The material parameters may be defined with the specification of the units. The elastic properties are:</p><pre><code class="language-julia hljs">E = 200.0 * phun(&quot;GPa&quot;)
nu = 0.3;</code></pre><p>The mass density is</p><pre><code class="language-julia hljs">rho = 8000 * phun(&quot;kg/m^3&quot;)</code></pre><p>Here are the cross-sectional dimensions and the length of the beam between supports.</p><pre><code class="language-julia hljs">radius = 1.0 * phun(&quot;m&quot;); diameter = 0.1 * phun(&quot;m&quot;);</code></pre><p>We shall calculate these eigenvalues, but we are mostly interested in the first three  natural frequencies.</p><pre><code class="language-julia hljs">neigvs = 18;</code></pre><p>The mass shift needs to be applied since the structure is free-floating.</p><pre><code class="language-julia hljs">oshift = (2*pi*15)^2</code></pre><p>Here we get to choose the model: Bernoulli or Timoshenko</p><pre><code class="language-julia hljs">shear_correction_factor = 6/7 # Timoshenko</code></pre><p>shear<em>correction</em>factor = Inf # Bernoulli</p><pre><code class="language-julia hljs">cs = CrossSectionCircle(s -&gt; diameter/2, s -&gt; [1.0, 0.0, 0.0], shear_correction_factor)
@show cs.parameters(0.0)</code></pre><p>Here we can choose the mass- matrix type:</p><pre><code class="language-julia hljs">mtype = MASS_TYPE_CONSISTENT_NO_ROTATION_INERTIA
mtype = MASS_TYPE_CONSISTENT_WITH_ROTATION_INERTIA
mtype = MASS_TYPE_LUMPED_DIAGONAL_NO_ROTATION_INERTIA
mtype = MASS_TYPE_LUMPED_DIAGONAL_WITH_ROTATION_INERTIA</code></pre><p>Here are the formulas for the first two natural frequencies, obtained analytically with the shear flexibility  neglected. The parameters of the structure:</p><pre><code class="language-julia hljs">R = radius
Im = cs.parameters(0.0)[4]
m = rho * cs.parameters(0.0)[1]</code></pre><p>For instance the the first out of plane mode is listed in this table as</p><pre><code class="language-julia hljs">J = cs.parameters(0.0)[2]
G = E/2/(1+nu)
i = 2 # the first non-rigid body mode
@show i*(i^2-1)/(2*pi*R^2)*sqrt(E*Im/m/(i^2+E*Im/G/J))</code></pre><p>The first &quot;ovaling&quot; (in-plane) mode is:</p><pre><code class="language-julia hljs">i=2 # the first ovaling mode
@show i*(i^2-1)/(2*pi*R^2*(i^2+1)^(1/2))*sqrt(E*Im/m)

material = MatDeforElastIso(DeforModelRed3D, rho, E, nu, 0.0)</code></pre><p>We will generate this many elements  along the length of the circular ring.</p><pre><code class="language-julia hljs">results = let
    results = []
    for i in 1:3
        n = 10*2^i</code></pre><p>beam elements along the member.</p><pre><code class="language-julia hljs">        tolerance = radius/n/1000;</code></pre><p>Generate the mesh of a straight member.</p><pre><code class="language-julia hljs">        fens, fes = frame_member([0 0 0; 2*pi 0 0], n, cs)</code></pre><p>Twist the straight member into a ring.</p><pre><code class="language-julia hljs">        for i in 1:count(fens)
            a = fens.xyz[i, 1]
            fens.xyz[i, :] .= (radius+radius*cos(a), radius*sin(a), 0)
        end</code></pre><p>Merge the nodes of the bases, which involves renumbering the connectivity.</p><pre><code class="language-julia hljs">        fens, fes = mergenodes(fens, fes, tolerance, [1, n+1])</code></pre><p>Generate the discrete model.</p><pre><code class="language-julia hljs">        geom0 = NodalField(fens.xyz)
        u0 = NodalField(zeros(size(fens.xyz, 1), 3))
        using FinEtoolsFlexStructures.RotUtilModule: initial_Rfield
        Rfield0 = initial_Rfield(fens)
        dchi = NodalField(zeros(size(fens.xyz, 1), 6))
        applyebc!(dchi)
        numberdofs!(dchi);
        femm = FEMMCorotBeam(IntegDomain(fes, GaussRule(1, 2)), material);
        K = CB.stiffness(femm, geom0, u0, Rfield0, dchi);
        M = CB.mass(femm, geom0, u0, Rfield0, dchi; mass_type = mtype);</code></pre><p>Solve the free vibration problem.</p><pre><code class="language-julia hljs">        evals, evecs, nconv = eigs(K + oshift * M, M; nev=neigvs, which=:SM, ncv = 3*neigvs, maxiter = 2000, explicittransform = :none);</code></pre><p>Correct for the mass shift.</p><pre><code class="language-julia hljs">        evals = evals .- oshift;
        sigdig(n) = round(n * 10000) / 10000
        fs = real(sqrt.(complex(evals)))/(2*pi)
        println(&quot;Eigenvalues: $(sigdig.(fs)) [Hz]&quot;)
        push!(results, (fs[6+1], fs[6+3], fs[6+5]))
    end
    results # return these values from the block
end

@show results

#</code></pre><h2 id="Richardson-extrapolation"><a class="docs-heading-anchor" href="#Richardson-extrapolation">Richardson extrapolation</a><a id="Richardson-extrapolation-1"></a><a class="docs-heading-anchor-permalink" href="#Richardson-extrapolation" title="Permalink"></a></h2><p>Here we will use Richardson extrapolation from the three sets of data. This will allow us to predict the convergence rate and the true solution for each of the three frequencies (or rather the pairs of frequencies, 7 and 8, 9 and 10, and 11 and 12).</p><p>We will immediately set up the convergence plots. We will extrapolate and then compute from that the normalized error to be plotted with respect to the refinement factors (which in this case are 4, 2, and 1). We use the refinement factor as a convenience: we will calculate the element size by dividing the circumference of the ring with a number of elements generated circumferentially.</p><pre><code class="language-julia hljs">using FinEtools.AlgoBaseModule: richextrapol

using Gnuplot
@gp  &quot;set terminal windows 1 &quot;  :-</code></pre><p>Modes 7 and 8</p><pre><code class="language-julia hljs">sols = [r[1] for r in results]
resextrap = richextrapol(sols, [4.0, 2.0, 1.0])
print(&quot;Predicted frequency 7 and 8: $(resextrap[1])\n&quot;)
errs = abs.(sols .- resextrap[1])./resextrap[1]
@gp  :- 2*pi*radius./[80, 160, 320] errs &quot; lw 2 lc rgb &#39;red&#39; with lp title &#39;Mode 7, 8&#39; &quot;  :-</code></pre><p>Modes 9 and 10</p><pre><code class="language-julia hljs">sols = [r[2] for r in results]
resextrap = richextrapol(sols, [4.0, 2.0, 1.0])
print(&quot;Predicted frequency 9 and 10: $(resextrap[1])\n&quot;)
errs = abs.(sols .- resextrap[1])./resextrap[1]
@gp  :- 2*pi*radius./[80, 160, 320] errs &quot; lw 2 lc rgb &#39;green&#39; with lp title &#39;Mode 9, 10&#39; &quot;  :-</code></pre><p>Modes 11 and 12</p><pre><code class="language-julia hljs">sols = [r[3] for r in results]
resextrap = richextrapol(sols, [4.0, 2.0, 1.0])
print(&quot;Predicted frequency 11 and 12: $(resextrap[1])\n&quot;)
errs = abs.(sols .- resextrap[1])./resextrap[1]
@gp  :- 2*pi*radius./[80, 160, 320] errs &quot; lw 2 lc rgb &#39;blue&#39; with lp title &#39;Mode 11, 12&#39; &quot;  :-

@gp  :- &quot;set xrange [0.01:0.1]&quot; &quot;set logscale x&quot; :-
@gp  :- &quot;set logscale y&quot; :-
@gp  :- &quot;set xlabel &#39;Element size&#39;&quot; :-
@gp  :- &quot;set ylabel &#39;Normalized error [ND]&#39;&quot; :-
@gp  :- &quot;set title &#39;Beam: Convergence of modes 7, ..., 12&#39;&quot;</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 14 January 2022 01:13">Friday 14 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
