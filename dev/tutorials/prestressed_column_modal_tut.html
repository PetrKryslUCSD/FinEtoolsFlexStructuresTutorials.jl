<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Prestressed simply-supported column modal analysis · FinEtoolsFlexStructuresTutorials.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">FinEtoolsFlexStructuresTutorials.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="tutorials.html">Tutorials</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="prestressed_column_modal_tut.html">Prestressed simply-supported column modal analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="prestressed_column_modal_tut.html">Prestressed simply-supported column modal analysis</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PetrKryslUCSD/FinEtoolsFlexStructuresTutorials.jl/blob/master/docs/src/tutorials/prestressed_column_modal_tut.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Prestressed-simply-supported-column-modal-analysis"><a class="docs-heading-anchor" href="#Prestressed-simply-supported-column-modal-analysis">Prestressed simply-supported column modal analysis</a><a id="Prestressed-simply-supported-column-modal-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Prestressed-simply-supported-column-modal-analysis" title="Permalink"></a></h1><p>Source code: <a href="prestressed_column_modal_tut.jl"><code>prestressed_column_modal_tut.jl</code></a></p><h2 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h2><p>Vibration analysis of a simply supported column loaded with axial force. The fundamental vibration frequency depends on the prestress force.</p><h2 id="Goals"><a class="docs-heading-anchor" href="#Goals">Goals</a><a id="Goals-1"></a><a class="docs-heading-anchor-permalink" href="#Goals" title="Permalink"></a></h2><ul><li>Demonstrate the change in the fundamental vibration frequency due to the prestress through an axial force.</li><li>Show how to evaluate the geometric stiffness from a static solution.</li><li>Solve the eigenvalue free vibration problem with the inclusion of the geometric stiffness matrix.</li></ul><pre><code class="language-julia hljs">#</code></pre><h2 id="Definition-of-the-basic-inputs"><a class="docs-heading-anchor" href="#Definition-of-the-basic-inputs">Definition of the basic inputs</a><a id="Definition-of-the-basic-inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-the-basic-inputs" title="Permalink"></a></h2><p>The finite element code realize on the basic functionality implemented in this package.</p><pre><code class="language-julia hljs">using FinEtools</code></pre><p>The material parameters may be defined with the specification of the units. The elastic properties are:</p><pre><code class="language-julia hljs">E = 30002.0 * phun(&quot;ksi&quot;)
nu = 0.0;</code></pre><p>The mass density is expressed in customary units as</p><pre><code class="language-julia hljs">g = 32.17*12 * phun(&quot;in/sec^2&quot;)
rho = 4.65 * phun(&quot;oz/in ^3&quot;) / g</code></pre><p>Here are the cross-sectional dimensions and the length of the beam between supports.</p><pre><code class="language-julia hljs">b = 1.8 * phun(&quot;in&quot;); h = 1.8 * phun(&quot;in&quot;); L = 300 * phun(&quot;in&quot;);

#</code></pre><h2 id="Cross-section"><a class="docs-heading-anchor" href="#Cross-section">Cross-section</a><a id="Cross-section-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-section" title="Permalink"></a></h2><p>Cross-sectional properties are incorporated in the cross-section property. The three arguments supplied are functions. All are returning &quot;constants&quot;. In particular the first two functions each return the dimension of the cross-section as a constant(the beam has a uniform cross-section); the third function defines the orientation of the cross-section in the global Cartesian coordinates. <code>[1.0, 0.0, 0.0]</code> is the vector that together with the tangent to the midline curve of the beam spans the <span>$x_1x_2$</span> plane of the local coordinates for the beam.</p><pre><code class="language-julia hljs">using FinEtoolsFlexStructures.CrossSectionModule: CrossSectionRectangle
cs = CrossSectionRectangle(s -&gt; b, s -&gt; h, s -&gt; [1.0, 0.0, 0.0])</code></pre><p>Here we retrieve the cross-sectional properties at the arc length 0.0.</p><pre><code class="language-julia hljs">@show A, J, I1, I2, I3 = cs.parameters(0.0)

#</code></pre><h2 id="Analytical-frequencies"><a class="docs-heading-anchor" href="#Analytical-frequencies">Analytical frequencies</a><a id="Analytical-frequencies-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-frequencies" title="Permalink"></a></h2><p>The analytical frequencies were taken from table 8-1 of Formulas for natural frequency and mode shape, Robert D. Blevins, Krieger publishing company, Malabar Florida, reprint edition 2001.</p><p>The beam has cylindrical supports at either end.</p><p>Simply supported column without a pre-stressing force has a fundamental frequency of</p><pre><code class="language-julia hljs">@show analyt_freq = (1*pi)^2/(2*pi*L^2)*sqrt(E*I2/rho/A);</code></pre><p>The critical Euler buckling load (simple-support): (pi^2<em>E</em>I2/L^2).</p><pre><code class="language-julia hljs">@show PEul = (pi^2*E*I2/L^2);</code></pre><p>Ps=linspace(-1, 1, 100);</p><p>The purpose of the numerical model is to calculate approximation to the fundamental analytical natural frequency.</p><pre><code class="language-julia hljs">neigvs = 1;</code></pre><p>Now we generate the mesh of the beam. The locations of its two endpoints are:</p><pre><code class="language-julia hljs">xyz = [[0 -L/2 0]; [0 L/2 0]]</code></pre><p>We will generate</p><pre><code class="language-julia hljs">n = 20</code></pre><p>beam elements along the member.</p><pre><code class="language-julia hljs">using FinEtoolsFlexStructures.MeshFrameMemberModule: frame_member
fens, fes = frame_member(xyz, n, cs);


#</code></pre><h2 id="Material"><a class="docs-heading-anchor" href="#Material">Material</a><a id="Material-1"></a><a class="docs-heading-anchor-permalink" href="#Material" title="Permalink"></a></h2><p>Material properties can be now used to create a material: isotropic elasticity model of the <code>FinEtoolsDeforLinear</code> package is instantiated.</p><pre><code class="language-julia hljs">using FinEtoolsDeforLinear
material = MatDeforElastIso(DeforModelRed3D, rho, E, nu, 0.0)

#</code></pre><h2 id="Fields"><a class="docs-heading-anchor" href="#Fields">Fields</a><a id="Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Fields" title="Permalink"></a></h2><p>Now we start constructing the discrete finite element model. We begin by constructing the requisite fields, geometry and displacement. These are the so-called &quot;configuration variables&quot;, all initialized to 0. This is that geometry field.</p><pre><code class="language-julia hljs">geom0 = NodalField(fens.xyz)</code></pre><p>This is the displacement field, three unknown displacements per node.</p><pre><code class="language-julia hljs">u0 = NodalField(zeros(size(fens.xyz, 1), 3))</code></pre><p>This is the rotation field, three unknown rotations per node are represented with a rotation matrix, in total nine numbers. The utility function <code>initial_Rfield</code></p><pre><code class="language-julia hljs">using FinEtoolsFlexStructures.RotUtilModule: initial_Rfield
Rfield0 = initial_Rfield(fens)</code></pre><p>Finally, this is the displacement and rotation field for incremental changes, incremental displacements and incremental rotations. In total, 6 unknowns per node.</p><pre><code class="language-julia hljs">dchi = NodalField(zeros(size(fens.xyz, 1), 6))

#</code></pre><h2 id="Support-conditions"><a class="docs-heading-anchor" href="#Support-conditions">Support conditions</a><a id="Support-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Support-conditions" title="Permalink"></a></h2><p>Now we apply the essential boundary conditions (EBCs) to enforce the action of the supports at the ends of the beam.</p><p>First we select the node at the location  <code>[0 -L/2 0]</code>. This is the immovable node.</p><pre><code class="language-julia hljs">immovable = selectnode(fens; box=[0 0 -L/2 -L/2 0 0], tolerance=L/n/1000)[1]</code></pre><p>The boundary condition at this point dictates zero displacements (degrees of freedom 1, 2, and 3) and zero rotations about the axis of the beam (degree of freedom 5).</p><pre><code class="language-julia hljs">for i in [1,2,3,5]
    setebc!(dchi, [immovable], true, i)
end</code></pre><p>Similarly, the node next to the other end of the beam is selected. This node is to be exposed to the external loading through the axial force.</p><pre><code class="language-julia hljs">movable = selectnode(fens; box=[0 0 L/2  L/2 0 0], tolerance=L/n/1000)[1]</code></pre><p>This time the transverse displacements and the axial rotation are suppressed.</p><pre><code class="language-julia hljs">for i in [1,3,5]
    setebc!(dchi, [movable], true, i)
end</code></pre><p>These boundary conditions now need to be &quot;applied&quot;. This simply means that the prescribed values of the degrees of freedom are copied into the active degrees of freedom.</p><pre><code class="language-julia hljs">applyebc!(dchi)</code></pre><p>The essential boundary conditions will also reduce the number of free (unknown) degrees of freedom.</p><pre><code class="language-julia hljs">numberdofs!(dchi);</code></pre><p>Here we inspect the degrees of freedom in the incremental displacement/rotation field:</p><pre><code class="language-julia hljs">@show dchi.dofnums</code></pre><p>Note that the degrees of freedom are actually carried by the incremental field, not by the displacement or the rotation fields.</p><pre><code class="language-julia hljs">#</code></pre><h2 id="Assemble-the-global-discrete-system"><a class="docs-heading-anchor" href="#Assemble-the-global-discrete-system">Assemble the global discrete system</a><a id="Assemble-the-global-discrete-system-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-global-discrete-system" title="Permalink"></a></h2><pre><code class="language-julia hljs">using FinEtoolsFlexStructures.FEMMCorotBeamModule: FEMMCorotBeam
femm = FEMMCorotBeam(IntegDomain(fes, GaussRule(1, 2)), material);</code></pre><p>For disambiguation we will refer to the stiffness and mass functions by qualifying them with the corotational-beam module, <code>FEMMCorotBeamModule</code>.</p><pre><code class="language-julia hljs">using FinEtoolsFlexStructures.FEMMCorotBeamModule
CB = FEMMCorotBeamModule</code></pre><p>Thus we can construct the stiffness matrix as follows: Note that the finite element machine is the first argument. This provides access to the integration domain. The next argument is the geometry field, followed by the displacement, rotations, and incremental displacement/rotation fields.</p><pre><code class="language-julia hljs">K = CB.stiffness(femm, geom0, u0, Rfield0, dchi);</code></pre><p>Now we construct the means of applying the concentrated force of prestress at the movable node. The node is the &quot;boundary&quot; of the domain of the column.</p><pre><code class="language-julia hljs">loadbdry = FESetP1(reshape([movable], 1, 1))</code></pre><p>The concentrated force can be considered a distributed loading at a single point. This distributed loading can be integrated with a quadrature rule suitable for a single point domains.</p><pre><code class="language-julia hljs">lfemm = FEMMBase(IntegDomain(loadbdry, PointRule()))</code></pre><p>We assume that the magnitude of the force is unity. Note that the force is applied in the positive direction along the beam, meaning as tensile. Therefore, buckling will be caused by applying  a negative buckling factor. Numerically, the buckling factor corresponding to failure is then of the magnitude of the Euler force.</p><pre><code class="language-julia hljs">fi = ForceIntensity(FFlt[0, 1.0, 0, 0, 0, 0]);</code></pre><p>The distributed loading is now integrated over the &quot;volume&quot; of the integration domain.</p><pre><code class="language-julia hljs">F = CB.distribloads(lfemm, geom0, dchi, fi, 3);</code></pre><p>Solve for the displacement under @show the static load</p><pre><code class="language-julia hljs">scattersysvec!(dchi, K\F);</code></pre><p>Update deflections so that the initial stress can be computed. First the displacements:</p><pre><code class="language-julia hljs">u1 = deepcopy(u0)
u1.values .= dchi.values[:, 1:3]</code></pre><p>Then the rotations:</p><pre><code class="language-julia hljs">Rfield1 = deepcopy(Rfield0)
using FinEtoolsFlexStructures.RotUtilModule:  update_rotation_field!
update_rotation_field!(Rfield1, dchi)</code></pre><p>The static deflection is now used to compute the internal forces which in turn lead to the geometric stiffness matrix.</p><pre><code class="language-julia hljs">Kg = CB.geostiffness(femm, geom0, u1, Rfield1, dchi);</code></pre><p>Now we can evaluate the mass matrix,</p><pre><code class="language-julia hljs">M = CB.mass(femm, geom0, u0, Rfield0, dchi);</code></pre><p>and we have the complete discrete model for the solution of the free vibration problem.</p><pre><code class="language-julia hljs">#</code></pre><h2 id="Solve-the-free-vibration-problem"><a class="docs-heading-anchor" href="#Solve-the-free-vibration-problem">Solve the free-vibration problem</a><a id="Solve-the-free-vibration-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-the-free-vibration-problem" title="Permalink"></a></h2><p>The Arnoldi algorithm implemented in the well-known <code>Arpack</code> package is used to solve the generalized eigenvalue problem with the sparse matrices. As is common in structural dynamics, we request the smallest eigenvalues in absolute value (<code>:SM</code>).</p><pre><code class="language-julia hljs">using Arpack</code></pre><p>The prestress-modified natural frequencies are computed in the loop for a number of prestress force values.</p><pre><code class="language-julia hljs">Ps = collect(linearspace(-1.0, 1.0, 50)).*PEul
freqs = let freqs =[];
    for P in Ps</code></pre><p>Note that we take the complete stiffness matrix: elastic plus prestress (initial stress).</p><pre><code class="language-julia hljs">        evals, evecs, nconv = eigs(K + P.*Kg, M; nev=neigvs, which=:SM, explicittransform = :none);</code></pre><p>The fundamental frequency:</p><pre><code class="language-julia hljs">        f = sqrt(evals[1]) / (2 * pi);
        push!(freqs, f);
    end
    freqs
end</code></pre><p>Show the normalized force and the fundamental frequencies.</p><pre><code class="language-julia hljs">sigdig(n) = round(n * 1000) / 1000
@show sigdig.(Ps./PEul), sigdig.(freqs)

#</code></pre><h2 id="Present-a-plot"><a class="docs-heading-anchor" href="#Present-a-plot">Present a plot</a><a id="Present-a-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Present-a-plot" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Gnuplot


@gp  &quot;set terminal windows 0 &quot;  :-

@gp  :- Ps./PEul freqs./analyt_freq &quot; lw 2 lc rgb &#39;red&#39; with p title &#39;Fundamental frequency&#39; &quot;  :-

@gp  :- &quot;set xlabel &#39;P/P_{Euler}&#39;&quot; :-
@gp  :- &quot;set ylabel &#39;Frequency(P)/Frequency(0) [Hz]&#39;&quot; :-
@gp  :- &quot;set title &#39;Prestressed column&#39;&quot;

nothing</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 14 January 2022 01:13">Friday 14 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
